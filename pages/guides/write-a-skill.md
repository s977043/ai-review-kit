# スキル作成ガイド（How-to）

このガイドは、River Reviewer のスキル（`skills/**/*.md`）を追加・更新するときに、迷いを減らし、品質のブレを抑えるための「書き方」をまとめたものです。

## 目的（Goals）

- 1スキル = 1観点で、指摘の粒度と意図を揃える
- 誤検知（うるさいだけ）を減らし、レビューを読みやすくする
- 変更に強い（拡張しても運用が崩れない）スキルを書く

## 非目的（Non-goals）

- スキル本文で「実装方法」や「プロジェクト固有の事情」を断定しない
- “nit” を増やすためのスキルを作らない（重要度と効果が薄い指摘の濫発は避ける）

## スキルの構造

スキルは YAML frontmatter（メタデータ）と Markdown 本文（指示文）で構成します。

- メタデータ: ルーティング・検証・優先度のための情報
- 本文: レビュアー（LLM/ヒューリスティック）が従うチェック観点と書き方

メタデータの定義は `schemas/skill.schema.json`、一覧は `pages/reference/metadata-fields.md` を参照してください。

## 推奨テンプレ（最小）

新規作成時は `skill_template.md` をベースにし、まずは次を揃えます。

- `applyTo` を絞る（いきなり `**/*` にしない）
- “黙る条件” を書く（誤検知ガード）
- “扱わない領域” を書く（Non-goals）
- 指摘文は短くし、次の行動へつながるようにする

## Severity の基準（目安）

`severity` は「レビューを受けた人がどう扱うべきか」の目安です。

- `critical`: セキュリティ事故やデータ破壊につながる、即対応が必要
- `major`: バグ・運用障害のリスクが高い、原則対応したい
- `minor`: 将来の保守性・読みやすさに効く、余力があれば直したい
- `info`: 判断材料の提示（“検討ポイント”）

## Evidence（根拠）の必須要件

River Reviewer のコメントは `<file>:<line>: <message>` 形式で投稿されます。最低限、以下を満たしてください。

- **どこを見て言っているか**が分かる（ファイルと行に紐づく）
- **推測を断定しない**（不確実な場合は “可能性” として書く）
- **再現や確認の手がかり**がある（何を確認すれば良いか）

## 推奨: 指摘文の型（短文版）

`<message>` は長くできないため、短くても読みやすい「型」を揃えます。

- Finding: 何が問題か（1文）
- Impact: 何が困るか（短く）
- Fix: 最小の修正案（次の一手）

例:

- `src/foo.ts:42: 例外が握りつぶされる可能性。障害調査が困難。Fix: catch でログ+再throw（or 呼び出し元へ返す）`

## 禁止事項（アンチパターン）

- 断定口調の決め打ち（「必ず〜」「〜に違いない」）
- 状況依存の押し付け（プロジェクトの前提が不明なのに “こうすべき” を断言）
- “nit” の濫発（意味の薄い指摘を大量に出す）
- 差分と無関係な一般論の連発

## PR 時の最小チェック

スキルを追加・更新したら、PR 本文に以下を残します。

- `npm run skills:validate`
- `npm test`
- 可能なら “誤検知ガード/Non-goals” の確認観点（何を言わないか）
